# カート注文(受注するまで)について
カートで注文を確定するためにユーザーが行う作業(フロー)を記載する。
カートインのタイミングで料金の計算や配達日指定のルールなどが決めることもあり、行う処理は多い。

- ①会員情報があればログイン、なければ新規登録かゲスト購入の選択
- ②商品と数量の確認
- ③オプションの選択
- ④支払い方法の選択
- ⑤配送先や配送方法、配送日時の選択
- ⑥送料の算出
- ⑦キャンペーン(値引き、クーポン利用)
- ⑧ポイント利用
- ⑨税額計算、合計計算
- ⑩注文の確定

それぞれに多様な要件がある。

![受注後のステータスフロー](https://github.com/commerble/ecspec/blob/master/specs/media/order.jpg)


## ①会員(ログイン、新規登録、ゲスト購入）
- 会員については以下を参照。
- [会員について](https://github.com/commerble/ecspec/blob/master/specs/Member.md)
- 会員IDはどこで管理するか、自社ECか、それ以外のIdp(アイデンティティ・プロバイダ)か。
- 購入には会員登録が必須か、ゲスト購入も可能とするか。
- ゲスト購入後に会員登録するような仕様を設けるかなどが検討事項として存在する。


## ②商品と数量の確認
- 商品展開し、商品と数量の確認を行う。
- 販売可能数をチェックする。
- 付与キャンペーン(後述)を確認する
- 在庫チェックする
- 商品販売パターンをチェックする。
- 同じカートに同梱不可能な商品(同時購入不能な商品、例えば常温商品と冷凍商品、一般商品と予約商品)をチェックする。
- 税額を算出する。
- 小計を算出する。


## ③オプションの選択
オプションについては様々な選択肢があるので、利用したケースを記載していく。

### オプション(ギフト梱包)
- ギフト梱包はECでは一般的となっている。有料のもの無料のもの。
- ギフト梱包はすべての商品で有効か、特定商品では使えないなどがある。
- ギフト梱包はクリスマスや父の日など特定の日付近にのみ有効なものも存在する。

### オプション(裾上げ)
- 裾上げ(Nセンチメートル)

### オプション(建材EC例)
- 荷受け担当者、出荷証明書有無、搬入制限


## ④支払い方法の選択
支払い方法については別ページを参照。
- [支払い方法について](https://github.com/commerble/ecspec/blob/master/specs/Payment.md)


## ⑤配送先や配送方法、配送日時の選択
- 配送先の新規設定もしくは登録済みの住所から選択する。


### 配送先
- 会員情報に配送先があればその情報を表示する。
- その他の配送先情報がある場合は、その選択も可能。


### 配送方法
- 配送方法としては、業者(クロネコヤマト、佐川)があり、宅配便(サイズ別)、ネコポス、EMSなどがある。これらは送料に影響する。(後述)
- 配送日時は、業者や契約条件によって異なるので、それぞれの配達可能時間帯をマスタ情報として管理する。


### 店舗受取
- 店舗受取する場合は、受取店舗の選択を行う。


## ⑥送料の算出
- 送料は、配送方法と配送先で異なる。
- 配送方法としては、業者(クロネコヤマト、佐川)があり、宅配便(サイズ別)、ネコポス、EMSの違いがある。
- 配送先別送料として、地域や都道府県や郵便番号別に異なるか、離島に対応しているかの違いがある。
- 送料がカートでの確定時に決められない場合、離島は通販基幹で注文を止め(特定の郵便番号で検知)、再計算し、顧客に提示する方法を取ることもある。家具などサイズの大きい商品を多く扱っていて配送料の金額が高い場合は、このような手法が効果的。


## ⑦キャンペーン(値引き、クーポン利用)、ポイント利用
値引きにはいろいろな方法があるが、キャンペーンという考え方でまとめる。
値引きの種類には下記のようなものが該当し、商品カテゴリや商品単位で設定する。

- ボリュームディスカウント＝N点以上買うとM円引き。
- 定率引き、定額引き。
- ポイント付与倍率の変更。
- それぞれ、小数点以下をどうするか調整が必要。


### クーポン
- クーポンは上記キャンペーンを発動させるためにクーポンコードを入れるというような利用形式が多い。
クーポンで値引きをするという考え方よりは、クーポンでキャンペーン(値引き)を発動するような仕様とする。


## ⑧ポイント利用
ポイント付与と利用について決めるべき仕様は以下のような点がある。
経理上の処理、法的制限がないか確認する。

- ポイントをどこで管理するか。ポイントについてはEC単独で持つケース、店舗と共通にするためPOS側(基幹側)でポイントを持つこともある。
- ポイントの利用用途は、利用ポイントは 1pt = 1円で、1pt から購入商品金額・送料の支払に使えるなど使い方を定義する必要がある。
- ポイント利用ができない商品があるか検討する。
- ポイントはいつ失効するか(１年後、最終購入から１年後、失効しない等)


### ポイント付与
- ポイントはいつ付与されるか(出荷時もしくは、返品がなくなる出荷２週間後などが多いかもしれない)
- 付与ポイントの算出方法に関して計算式を用意する。


## ⑨税額計算
税額計算の特性についてまとめる。

- 税率の管理方法は期間的な管理が必要(いつからいつまでN％、いつからM％)
- 税額の具体的な計算式を用意する。


## ⑩注文の確定
注文の確定の際にも行う処理は多い。

- 在庫の確認
- クレジットカードのオーソリゼーション(同期で行うか非同期で行うか検討可能)
- NP後払いのリアルタイム与信


## 目次に戻る


- [目次に戻る](https://github.com/commerble/ecspec/blob/master/Readme.md)

